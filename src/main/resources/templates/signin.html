<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/metadata :: metadata}"></head>

<!-- Notification Style -->
<style th:replace="~{fragments/notification :: notification-style}"></style>

<body id="body">
<div th:replace="~{fragments/header :: header}"></div>

<!-- Notification -->
<div th:replace="~{fragments/notification :: notification}"></div>

<section class="signin-page account">
  <div class="container">
    <div class="row">
      <div class="col-md-6 col-md-offset-3">
        <div class="block text-center">
          <a class="logo" href="/">
            <img src="/images/logo.png" alt="">
          </a>
          <h2 class="text-center">Create Your Account</h2>

          <!-- Client-side validation alerts -->
          <div id="error-alert" class="alert alert-danger" style="display: none;" role="alert"></div>

          <form id="register-form" th:action="@{/auth/register}" method="post" th:object="${registerRequest}" class="text-left clearfix">
            <div class="form-group">
              <input type="text" id="fullName" name="fullName" th:field="*{fullName}" class="form-control" placeholder="Full Name" required>
            </div>
            <div class="form-group">
              <input type="email" id="email" name="email" th:field="*{email}" class="form-control" placeholder="Email" required>
            </div>
            <div class="form-group">
              <input type="tel" id="phone" name="phone" th:field="*{phone}" class="form-control" placeholder="Phone (e.g., 0765461705)" required pattern="[0-9]{10,11}">
            </div>
            <div class="form-group">
              <input type="password" id="password" name="password" th:field="*{password}" class="form-control" placeholder="Password (min 8 characters)" required minlength="8">
            </div>
            <div class="form-group">
              <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" placeholder="Confirm Password" required>
            </div>
            <div class="text-center">
              <button type="submit" class="btn btn-main text-center" id="register-btn">
                Sign Up
              </button>
            </div>
          </form>
          <p class="mt-20">Already have an account? <a href="/auth/login">Login</a></p>
          <p><a href="/auth/forget-password">Forgot your password?</a></p>
        </div>
      </div>
    </div>
  </div>
</section>

<div th:replace="~{fragments/footer :: footer}"></div>

<div th:replace="~{fragments/scripts :: scripts}"></div>

<!-- Notification Script -->
<script th:replace="~{fragments/notification :: notification-script}"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const registerForm = document.getElementById('register-form');
    const errorAlert = document.getElementById('error-alert');

    registerForm.addEventListener('submit', function(e) {
        // Hide previous alerts
        errorAlert.style.display = 'none';

        // Get form data
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;

        // Client-side validation for password match
        if (password !== confirmPassword) {
            e.preventDefault();
            showError('Passwords do not match');
            return false;
        }

        // Let the form submit normally to the controller
        return true;
    });

    function showError(message) {
        errorAlert.textContent = message;
        errorAlert.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });

        // Auto-hide after 4 seconds
        setTimeout(function() {
            errorAlert.style.display = 'none';
        }, 4000);
    }
});
</script>

</body>
</html>
